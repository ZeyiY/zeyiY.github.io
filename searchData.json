[{"title":"MEMçš„è‹±è¯­","url":"/2019/04/22/MEMçš„è‹±è¯­/","content":"\näº”å¤§åŸºæœ¬ç±»å‹ï¼š\n\nI love you.\n\nThe sun rises.\n\nI give you a book.\n\nI make you happy.\n\nI am happy."},{"title":"JAVAæ’ä»¶Lombokçš„ä½¿ç”¨æŒç»­æ›´æ–°","url":"/2019/04/17/JAVAæ’ä»¶Lombokçš„ä½¿ç”¨æŒç»­æ›´æ–°/","content":"\n##@Data\n\n\n\n##@Setter\n\n\n\n##@Getter\n\n\n\n##@EqualsAndHashCode\n\n\n\n##@ToString\n\n"},{"title":"è¿™äº›å¹´Mybatisä½¿ç”¨PageHelperè¿›è¡Œåˆ†é¡µæ‰çš„ä¸‹æ°´äº•ä»¥åŠå¡«äº•ç›–","url":"/2019/04/13/è¿™äº›å¹´Mybatisä½¿ç”¨PageHelperè¿›è¡Œåˆ†é¡µæ‰çš„ä¸‹æ°´äº•ä»¥åŠå¡«äº•ç›–/","content":"\n## è¿™äº›å¹´Mybatisä½¿ç”¨PageHelperè¿›è¡Œåˆ†é¡µæ‰çš„ä¸‹æ°´äº•ä»¥åŠå¡«äº•ç›–\n\n#### å‰è¨€\n\næ—¥å¸¸ä¸šåŠ¡å¼€å‘ä¸­ï¼Œåˆ—è¡¨åˆ†é¡µæŸ¥è¯¢çš„éœ€æ±‚éå¸¸å¸¸è§ï¼Œåœ¨Mybatis æ¶æ„ä¸­ï¼Œæˆ‘ä»¬åˆéå¸¸å–œæ¬¢ä½¿ç”¨[PageHelper](https://github.com/pagehelper/Mybatis-PageHelper) è¿™ä¸ªæ’ä»¶ï¼Œéå¸¸æ„Ÿè°¢å¼€æºè¿™ä¸ªæ’ä»¶çš„å¤§ä½¬ï½\n\nè™½ç„¶å¤§ä½¬æŠŠæ–‡æ¡£å†™çš„éå¸¸å…¨ï¼Œç„¶è€Œä¾ç„¶æ‰ä¸‹æ°´äº•ğŸ¤¦â€â™‚ï¸ï¼Œä»¥ä¸‹è®°å½•ä¸€ä¸‹æ‰çš„ä¸‹æ°´äº•ï¼Œä»¥åŠå¦‚ä½•å¡«äº•ç›–çš„è¿‡ç¨‹ã€‚\n\n[ä½¿ç”¨æ–‡æ¡£](https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md>)ä¸€å®šè¦ä»”ç»†çœ‹ï¼Œå¡«ç›–è¿‡ç¨‹ä¸­å¼•ç”¨äº†æ–‡æ¡£çš„ç›¸å…³å†…å®¹ã€‚\n\n#### é—®é¢˜æè¿°\n\nåœ¨å•å…ƒæµ‹è¯•æµ‹è¯•å’Œæµ‹è¯•ç¯å¢ƒä¸­åˆ†åˆ«å‡ºç°äº†ä¸¤ä¸ªé—®é¢˜ï¼Œè®©æˆ‘æ€€ç–‘äº†äººç”Ÿã€‚\n\nå•å…ƒæµ‹è¯•é—®é¢˜ï¼š\n\næŸ¥è¯¢æŠ¥é”™ï¼Œæ— ç¼˜æ— æ•…çš„åŠ äº†ä¸€ä¸ªorder by æ’åºï¼ŒæŸ¥çœ‹sql å’Œ æ–¹æ³•å¹¶æ²¡æœ‰order byçš„é€»è¾‘ï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–çš„é€»è¾‘(ä¹Ÿæ²¡æœ‰PageHelper é…ç½®)ï¼ŒçœŸçš„æ´»è§é¬¼äº†ï¼Œæœ€è§é¬¼çš„æ˜¯éå¿…ç°ã€‚\n\næµ‹è¯•ç¯å¢ƒé—®é¢˜ï¼š\n\nç¨‹åºæ‰§è¡Œä¸€æ®µæ—¶é—´åï¼Œä¸€ä¸ªåˆ†é¡µæ¥å£ç›´æ¥æŠ¥é”™äº†ï¼ŒæŠ¥é”™çš„å†…å®¹è§ä¸‹å›¾ï¼ŒåŒæ ·æ˜¯éç°ï¼Œä»£ç ä¹Ÿæ²¡æœ‰ç‰¹æ®Šçš„é€»è¾‘ï¼Œä¸€ä¸ªæŸ¥è¯¢ï¼Œä½¿ç”¨PageHelper.startPage(pageNum, pageSize)è¿›è¡Œåˆ†é¡µã€‚\n\n```\næŠ¥é”™ä¿¡æ¯ï¼š\n09:41:22.528 [http-nio-8080-exec-1] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.type.TypeException: Could not set parameters for mapping: ParameterMapping{property='Second_PageHelper', mode=IN, javaType=class java.lang.Integer, jdbcType=null, numericScale=null, resultMapId='null', jdbcTypeName='null', expression='null'}. Cause: org.apache.ibatis.type.TypeException: Error setting non null for parameter #1 with JdbcType null . Try setting a different JdbcType for this parameter or a different configuration property. Cause: java.sql.SQLException: Type not supported] with root cause\njava.sql.SQLException: Type not supported\nat com.informix.util.IfxErrMsg.buildException(IfxErrMsg.java:480)\nat com.informix.util.IfxErrMsg.getSQLException(IfxErrMsg.java:449)\nat com.informix.util.IfxErrMsg.getSQLException(IfxErrMsg.java:400)\nat com.informix.jdbc.IfxValue.getIfxTypeName(IfxValue.java:207)\nat com.informix.jdbc.IfxValue.makeInstance(IfxValue.java:342)\nat com.informix.jdbc.IfxValue.makeInstance(IfxValue.java:334)\nat com.informix.jdbc.IfxPreparedStatement.setInt(IfxPreparedStatement.java:989)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat org.apache.tomcat.jdbc.pool.StatementFacade$StatementProxy.invoke(StatementFacade.java:114)\nat com.sun.proxy.$Proxy133.setInt(Unknown Source)\nat org.apache.ibatis.type.IntegerTypeHandler.setNonNullParameter(IntegerTypeHandler.java:31)\nat org.apache.ibatis.type.IntegerTypeHandler.setNonNullParameter(IntegerTypeHandler.java:26)\nat org.apache.ibatis.type.BaseTypeHandler.setParameter(BaseTypeHandler.java:53)\nat org.apache.ibatis.scripting.defaults.DefaultParameterHandler.setParameters(DefaultParameterHandler.java:87)\nat org.apache.ibatis.executor.statement.PreparedStatementHandler.parameterize(PreparedStatementHandler.java:93)\nat org.apache.ibatis.executor.statement.RoutingStatementHandler.parameterize(RoutingStatementHandler.java:64)\nat org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:86)\nat org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)\nat org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326)\nat org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)\nat org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)\nat com.github.pagehelper.PageInterceptor.intercept(PageInterceptor.java:136)\nat org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:61)\nat com.sun.proxy.$Proxy131.query(Unknown Source)\nat org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)\nat org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)\nat com.sun.proxy.$Proxy81.selectList(Unknown Source)\nat org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)\nat org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:139)\nat org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:76)\nat org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:59)\nat com.sun.proxy.$Proxy87.selectByExample(Unknown Source)\nat com.ccb.hebei.zcyd.dao.service.impl.ContractRecordStateServiceImpl.search(ContractRecordStateServiceImpl.java:50)\nat com.ccb.hebei.zcyd.web.api.RecordStateApi.search(RecordStateApi.java:42)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\nat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)\nat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)\nat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\nat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)\nat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)\nat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)\nat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:661)\nat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:742)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\nat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\nat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\nat org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\nat org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\nat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)\nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\nat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:496)\nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)\nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)\nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)\nat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)\nat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)\nat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:790)\nat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1459)\nat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\nat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\nat java.lang.Thread.run(Thread.java:745)\n```\n\n```\nä»£ç æ¨¡å—ï¼š\n PageHelper.startPage(pageNum, pageSize);\n list = countryMapper.selectIf(param1);\n```\n\n#### é—®é¢˜è§£æ\n\næ¬²è§£å†³é—®é¢˜ï¼Œå°±è¦äº†è§£PageHelperæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå¹¶ä¸”PageHelper.startPage(pageNum, pageSize) å¹²äº†å•¥äº‹ã€‚\n\nè¿™æ¬¡ç°çœ‹PageHelper.startPage(pageNum, pageSize)çš„æºç ï¼š\n\n```\n\npackage com.github.pagehelper.page;\n\nimport com.github.pagehelper.ISelect;\nimport com.github.pagehelper.Page;\nimport com.github.pagehelper.util.PageObjectUtil;\n\nimport java.util.Properties;\n\n/**\n * åŸºç¡€åˆ†é¡µæ–¹æ³•\n *\n * @author liuzh\n */\npublic abstract class PageMethod {\n    protected static final ThreadLocal<Page> LOCAL_PAGE = new ThreadLocal<Page>();\n    protected static boolean DEFAULT_COUNT = true;\n\n    /**\n     * è®¾ç½® Page å‚æ•°\n     *\n     * @param page\n     */\n    protected static void setLocalPage(Page page) {\n        LOCAL_PAGE.set(page);\n    }\n\n    /**\n     * è·å– Page å‚æ•°\n     *\n     * @return\n     */\n    public static <T> Page<T> getLocalPage() {\n        return LOCAL_PAGE.get();\n    }\n\n    /**\n     * ç§»é™¤æœ¬åœ°å˜é‡\n     */\n    public static void clearPage() {\n        LOCAL_PAGE.remove();\n    }\n\n    /**\n     * å¼€å§‹åˆ†é¡µ\n     *\n     * @param params\n     */\n    public static <E> Page<E> startPage(Object params) {\n        Page<E> page = PageObjectUtil.getPageFromObject(params, true);\n        //å½“å·²ç»æ‰§è¡Œè¿‡orderByçš„æ—¶å€™\n        Page<E> oldPage = getLocalPage();\n        if (oldPage != null && oldPage.isOrderByOnly()) {\n            page.setOrderBy(oldPage.getOrderBy());\n        }\n        setLocalPage(page);\n        return page;\n    }\n\n    /**\n     * å¼€å§‹åˆ†é¡µ\n     *\n     * @param pageNum  é¡µç \n     * @param pageSize æ¯é¡µæ˜¾ç¤ºæ•°é‡\n     */\n    public static <E> Page<E> startPage(int pageNum, int pageSize) {\n        return startPage(pageNum, pageSize, DEFAULT_COUNT);\n    }\n\n    /**\n     * å¼€å§‹åˆ†é¡µ\n     *\n     * @param pageNum  é¡µç \n     * @param pageSize æ¯é¡µæ˜¾ç¤ºæ•°é‡\n     * @param count    æ˜¯å¦è¿›è¡ŒcountæŸ¥è¯¢\n     */\n    public static <E> Page<E> startPage(int pageNum, int pageSize, boolean count) {\n        return startPage(pageNum, pageSize, count, null, null);\n    }\n\n    /**\n     * å¼€å§‹åˆ†é¡µ\n     *\n     * @param pageNum  é¡µç \n     * @param pageSize æ¯é¡µæ˜¾ç¤ºæ•°é‡\n     * @param orderBy  æ’åº\n     */\n    public static <E> Page<E> startPage(int pageNum, int pageSize, String orderBy) {\n        Page<E> page = startPage(pageNum, pageSize);\n        page.setOrderBy(orderBy);\n        return page;\n    }\n\n    /**\n     * å¼€å§‹åˆ†é¡µ\n     *\n     * @param pageNum      é¡µç \n     * @param pageSize     æ¯é¡µæ˜¾ç¤ºæ•°é‡\n     * @param count        æ˜¯å¦è¿›è¡ŒcountæŸ¥è¯¢\n     * @param reasonable   åˆ†é¡µåˆç†åŒ–,nullæ—¶ç”¨é»˜è®¤é…ç½®\n     * @param pageSizeZero trueä¸”pageSize=0æ—¶è¿”å›å…¨éƒ¨ç»“æœï¼Œfalseæ—¶åˆ†é¡µ,nullæ—¶ç”¨é»˜è®¤é…ç½®\n     */\n    public static <E> Page<E> startPage(int pageNum, int pageSize, boolean count, Boolean reasonable, Boolean pageSizeZero) {\n        Page<E> page = new Page<E>(pageNum, pageSize, count);\n        page.setReasonable(reasonable);\n        page.setPageSizeZero(pageSizeZero);\n        //å½“å·²ç»æ‰§è¡Œè¿‡orderByçš„æ—¶å€™\n        Page<E> oldPage = getLocalPage();\n        if (oldPage != null && oldPage.isOrderByOnly()) {\n            page.setOrderBy(oldPage.getOrderBy());\n        }\n        setLocalPage(page);\n        return page;\n    }\n.....å¿½ç•¥äº†ä¸€äº›ä»£ç ........\n}\n\n```\n\nå‘ç°PageHelperä¸­ä½¿ç”¨ThreadLocalï¼ŒThreadLocalæœ‰ä»€ä¹ˆç‰¹æ€§å‘¢ï¼Ÿè¯¦æƒ…è¯·çœ‹ä¸‹ç¯‡[æ–‡ç« ](https://zeyiy.github.io/2019/04/13/ThreadLocal%E7%9A%84%E7%90%86%E8%A7%A3/)è®²è§£ã€‚å…ˆè¯´ç»“è®ºï¼Œ\n\nç»“è®ºæ˜¯ï¼šåˆ†é¡µå‚æ•°å’Œçº¿ç¨‹æ˜¯ç»‘å®šçš„ã€‚\n\nåªè¦ä½ å¯ä»¥ä¿è¯åœ¨ `PageHelper` æ–¹æ³•è°ƒç”¨åç´§è·Ÿ MyBatis æŸ¥è¯¢æ–¹æ³•ï¼Œè¿™å°±æ˜¯å®‰å…¨çš„ã€‚å› ä¸º `PageHelper` åœ¨ `finally` ä»£ç æ®µä¸­è‡ªåŠ¨æ¸…é™¤äº† `ThreadLocal` å­˜å‚¨çš„å¯¹è±¡ã€‚\n\nå¦‚æœä»£ç åœ¨è¿›å…¥ `Executor` å‰å‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹ä¸å¯ç”¨ï¼Œè¿™å±äºäººä¸ºçš„ Bugï¼ˆä¾‹å¦‚æ¥å£æ–¹æ³•å’Œ XML ä¸­çš„ä¸åŒ¹é…ï¼Œå¯¼è‡´æ‰¾ä¸åˆ° `MappedStatement` æ—¶ï¼‰ï¼Œ è¿™ç§æƒ…å†µç”±äºçº¿ç¨‹ä¸å¯ç”¨ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ `ThreadLocal` å‚æ•°è¢«é”™è¯¯çš„ä½¿ç”¨ã€‚\n\nä¸å®‰å…¨çš„ä»£ç ç¤ºèŒƒï¼š\n\n```\nPageHelper.startPage(1, 10);\nList<Country> list;\nif(param1 != null){\n    list = countryMapper.selectIf(param1);\n} else {\n    list = new ArrayList<Country>();\n}\n```\n\nè¿™ç§æƒ…å†µä¸‹ç”±äº param1 å­˜åœ¨ null çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´ PageHelper ç”Ÿäº§äº†ä¸€ä¸ªåˆ†é¡µå‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œè¿™ä¸ªå‚æ•°å°±ä¼šä¸€ç›´ä¿ç•™åœ¨è¿™ä¸ªçº¿ç¨‹ä¸Šã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¢«ä½¿ç”¨æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´ä¸è¯¥åˆ†é¡µçš„æ–¹æ³•å»æ¶ˆè´¹è¿™ä¸ªåˆ†é¡µå‚æ•°ï¼Œè¿™å°±äº§ç”Ÿäº†è«åå…¶å¦™çš„åˆ†é¡µã€‚\n\nåŒæ ·orderByåŒç†ã€‚\n\næŸ¥çœ‹å…¨å±€ä»£ç å‘ç°ï¼Œç¡®å®æœ‰è¿™æ ·çš„ä»£ç é€»è¾‘ğŸ¤¦â€â™‚ï¸ã€‚è¿™åŒæ—¶è§£é‡Šäº†ä¸ºå•¥ä¸æ˜¯å¿…ç°çš„åŸå› äº†ï¼Œå› ä¸ºè§¦å‘æœªæ¶ˆè´¹çš„åˆ†é¡µå‚æ•°çš„é€»è¾‘ä¸æ˜¯æ¯æ¬¡éƒ½æ‰§è¡Œã€‚\n\n#### æ€ä¹ˆå¡«äº•ç›–å‘¢ï¼Ÿ\n\n1. PageHelper ç´§è·ŸæŸ¥è¯¢è¯­å¥\n\n```\nList<Country> list;\nif(param1 != null){\n    PageHelper.startPage(1, 10);\n    list = countryMapper.selectIf(param1);\n} else {\n    list = new ArrayList<Country>();\n}\n```\n\n2. åœ¨ä½¿ç”¨å®Œä¹‹åæ‰‹åŠ¨æ¸…ç©ºThreadLocal å­˜å‚¨çš„ä¿¡æ¯\n\n```\nPageHelper.clearPage();\n```\n\n3. Java8 lambdaç”¨æ³•\n\n```\nPage<Country> page = PageHelper.startPage(1, 10).doSelectPage(()-> countryMapper.selectGroupBy());\n\nPageInfo<Country> pageInfo = PageHelper.startPage(1, 10).doSelectPageInfo(() -> countryMapper.selectGroupBy());\n```\n\n"},{"title":"ThreadLocalçš„ç†è§£","url":"/2019/04/13/ThreadLocalçš„ç†è§£/","content":"\n## ThreadLocal æºç è§£æã€ä½¿ç”¨åœºæ™¯ä»‹ç»ã€æ³¨æ„äº‹é¡¹ç­‰\n\n#### å‰è¨€\n\nThreadLocal æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå®ƒæ˜¯ä¸€ä¸ªæœ¬åœ°çº¿ç¨‹å‰¯æœ¬å˜é‡å·¥å…·ç±»ï¼Œç”¨äºæä¾›çº¿ç¨‹å±€éƒ¨å˜é‡ã€‚ä¸»è¦ç”¨äºå°†ç§æœ‰çº¿ç¨‹å’Œè¯¥çº¿ç¨‹å­˜æ”¾çš„å‰¯æœ¬å¯¹è±¡åšä¸€ä¸ªæ˜ å°„ï¼Œå„ä¸ªçº¿ç¨‹ä¹‹é—´çš„å˜é‡äº’ä¸å¹²æ‰°ã€‚ä¾‹å¦‚ï¼šç”¨æˆ·IDæˆ–äº‹åŠ¡IDã€‚\n\n#### ThreadLocalå®ç°çš„æ•°æ®ç»“æ„\n\n\n\n#### æºç \n\n```\npackage java.lang;\nimport java.lang.ref.*;\nimport java.util.Objects;\nimport java.util.concurrent.atomic.AtomicInteger;\nimport java.util.function.Supplier;\n\npublic class ThreadLocal<T> {\n    \n    private final int threadLocalHashCode = nextHashCode();\n    \n    private static AtomicInteger nextHashCode = new AtomicInteger();\n\n    private static final int HASH_INCREMENT = 0x61c88647;\n\n    private static int nextHashCode() {\n        return nextHashCode.getAndAdd(HASH_INCREMENT);\n    }\n\n    protected T initialValue() {\n        return null;\n    }\n\n    public static <S> ThreadLocal<S> withInitial(Supplier<? extends S> supplier) {\n        return new SuppliedThreadLocal<>(supplier);\n    }\n\n   \n    public ThreadLocal() {\n    }\n\n    /**\n     * 1.è·å–å½“å‰çº¿ç¨‹çš„ThreadLocalMapå¯¹è±¡threadLocals\n     * 2.ä»mapä¸­è·å–çº¿ç¨‹å­˜å‚¨çš„K-V EntryèŠ‚ç‚¹ã€‚\n     * 3.ä»EntryèŠ‚ç‚¹è·å–å­˜å‚¨çš„Valueå‰¯æœ¬å€¼è¿”å›ã€‚\n     * 4.mapä¸ºç©ºçš„è¯è¿”å›åˆå§‹å€¼nullï¼Œå³çº¿ç¨‹å˜é‡å‰¯æœ¬ä¸ºnullï¼Œåœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„åˆ¤æ–­NullPointerExceptionã€‚\n     */\n    public T get() {\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null) {\n            ThreadLocalMap.Entry e = map.getEntry(this);\n            if (e != null) {\n                @SuppressWarnings(\"unchecked\")\n                T result = (T)e.value;\n                return result;\n            }\n        }\n        return setInitialValue();\n    }\n\n\n    private T setInitialValue() {\n        T value = initialValue();\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null)\n            map.set(this, value);\n        else\n            createMap(t, value);\n        return value;\n    }\n\n    /**\n     * 1.è·å–å½“å‰çº¿ç¨‹çš„æˆå‘˜å˜é‡map\n     * 2.mapéç©ºï¼Œåˆ™é‡æ–°å°†ThreadLocalå’Œæ–°çš„valueå‰¯æœ¬æ”¾å…¥åˆ°mapä¸­ã€‚\n     * 3.mapç©ºï¼Œåˆ™å¯¹çº¿ç¨‹çš„æˆå‘˜å˜é‡ThreadLocalMapè¿›è¡Œåˆå§‹åŒ–åˆ›å»ºï¼Œå¹¶å°†ThreadLocalå’Œvalueå‰¯æœ¬æ”¾å…¥mapä¸­ã€‚\n     */\n    public void set(T value) {\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null)\n            map.set(this, value);\n        else\n            createMap(t, value);\n    }\n\n\n     public void remove() {\n         ThreadLocalMap m = getMap(Thread.currentThread());\n         if (m != null)\n             m.remove(this);\n     }\n\n    \n    ThreadLocalMap getMap(Thread t) {\n        return t.threadLocals;\n    }\n\n\n    void createMap(Thread t, T firstValue) {\n        t.threadLocals = new ThreadLocalMap(this, firstValue);\n    }\n\n\n    static ThreadLocalMap createInheritedMap(ThreadLocalMap parentMap) {\n        return new ThreadLocalMap(parentMap);\n    }\n\n\n    T childValue(T parentValue) {\n        throw new UnsupportedOperationException();\n    }\n\n\n    static final class SuppliedThreadLocal<T> extends ThreadLocal<T> {\n\n        private final Supplier<? extends T> supplier;\n\n        SuppliedThreadLocal(Supplier<? extends T> supplier) {\n            this.supplier = Objects.requireNonNull(supplier);\n        }\n\n        @Override\n        protected T initialValue() {\n            return supplier.get();\n        }\n    }\n\n\n    static class ThreadLocalMap {\n\n     \n        static class Entry extends WeakReference<ThreadLocal<?>> {\n            \n            Object value;\n\n            Entry(ThreadLocal<?> k, Object v) {\n                super(k);\n                value = v;\n            }\n        }\n\n       \n        private static final int INITIAL_CAPACITY = 16;\n\n        \n        private Entry[] table;\n\n      \n        private int size = 0;\n\n        \n        private int threshold; // Default to 0\n\n        \n        private void setThreshold(int len) {\n            threshold = len * 2 / 3;\n        }\n\n        \n        private static int nextIndex(int i, int len) {\n            return ((i + 1 < len) ? i + 1 : 0);\n        }\n\n       \n        private static int prevIndex(int i, int len) {\n            return ((i - 1 >= 0) ? i - 1 : len - 1);\n        }\n\n        \n        ThreadLocalMap(ThreadLocal<?> firstKey, Object firstValue) {\n            table = new Entry[INITIAL_CAPACITY];\n            int i = firstKey.threadLocalHashCode & (INITIAL_CAPACITY - 1);\n            table[i] = new Entry(firstKey, firstValue);\n            size = 1;\n            setThreshold(INITIAL_CAPACITY);\n        }\n\n        \n        private ThreadLocalMap(ThreadLocalMap parentMap) {\n            Entry[] parentTable = parentMap.table;\n            int len = parentTable.length;\n            setThreshold(len);\n            table = new Entry[len];\n\n            for (int j = 0; j < len; j++) {\n                Entry e = parentTable[j];\n                if (e != null) {\n                    @SuppressWarnings(\"unchecked\")\n                    ThreadLocal<Object> key = (ThreadLocal<Object>) e.get();\n                    if (key != null) {\n                        Object value = key.childValue(e.value);\n                        Entry c = new Entry(key, value);\n                        int h = key.threadLocalHashCode & (len - 1);\n                        while (table[h] != null)\n                            h = nextIndex(h, len);\n                        table[h] = c;\n                        size++;\n                    }\n                }\n            }\n        }\n\n        \n        private Entry getEntry(ThreadLocal<?> key) {\n            int i = key.threadLocalHashCode & (table.length - 1);\n            Entry e = table[i];\n            if (e != null && e.get() == key)\n                return e;\n            else\n                return getEntryAfterMiss(key, i, e);\n        }\n\n        private Entry getEntryAfterMiss(ThreadLocal<?> key, int i, Entry e) {\n            Entry[] tab = table;\n            int len = tab.length;\n\n            while (e != null) {\n                ThreadLocal<?> k = e.get();\n                if (k == key)\n                    return e;\n                if (k == null)\n                    expungeStaleEntry(i);\n                else\n                    i = nextIndex(i, len);\n                e = tab[i];\n            }\n            return null;\n        }\n\n        private void set(ThreadLocal<?> key, Object value) {\n\n            Entry[] tab = table;\n            int len = tab.length;\n            int i = key.threadLocalHashCode & (len-1);\n\n            for (Entry e = tab[i];\n                 e != null;\n                 e = tab[i = nextIndex(i, len)]) {\n                ThreadLocal<?> k = e.get();\n\n                if (k == key) {\n                    e.value = value;\n                    return;\n                }\n\n                if (k == null) {\n                    replaceStaleEntry(key, value, i);\n                    return;\n                }\n            }\n\n            tab[i] = new Entry(key, value);\n            int sz = ++size;\n            if (!cleanSomeSlots(i, sz) && sz >= threshold)\n                rehash();\n        }\n\n        private void remove(ThreadLocal<?> key) {\n            Entry[] tab = table;\n            int len = tab.length;\n            int i = key.threadLocalHashCode & (len-1);\n            for (Entry e = tab[i];\n                 e != null;\n                 e = tab[i = nextIndex(i, len)]) {\n                if (e.get() == key) {\n                    e.clear();\n                    expungeStaleEntry(i);\n                    return;\n                }\n            }\n        }\n\n        private void replaceStaleEntry(ThreadLocal<?> key, Object value,\n                                       int staleSlot) {\n            Entry[] tab = table;\n            int len = tab.length;\n            Entry e;\n\n            int slotToExpunge = staleSlot;\n            for (int i = prevIndex(staleSlot, len);\n                 (e = tab[i]) != null;\n                 i = prevIndex(i, len))\n                if (e.get() == null)\n                    slotToExpunge = i;\n\n            for (int i = nextIndex(staleSlot, len);\n                 (e = tab[i]) != null;\n                 i = nextIndex(i, len)) {\n                ThreadLocal<?> k = e.get();\n\n\n                if (k == key) {\n                    e.value = value;\n\n                    tab[i] = tab[staleSlot];\n                    tab[staleSlot] = e;\n\n                    if (slotToExpunge == staleSlot)\n                        slotToExpunge = i;\n                    cleanSomeSlots(expungeStaleEntry(slotToExpunge), len);\n                    return;\n                }\n\n                if (k == null && slotToExpunge == staleSlot)\n                    slotToExpunge = i;\n            }\n\n            tab[staleSlot].value = null;\n            tab[staleSlot] = new Entry(key, value);\n\n            if (slotToExpunge != staleSlot)\n                cleanSomeSlots(expungeStaleEntry(slotToExpunge), len);\n        }\n\n        private int expungeStaleEntry(int staleSlot) {\n            Entry[] tab = table;\n            int len = tab.length;\n\n            // expunge entry at staleSlot\n            tab[staleSlot].value = null;\n            tab[staleSlot] = null;\n            size--;\n\n            // Rehash until we encounter null\n            Entry e;\n            int i;\n            for (i = nextIndex(staleSlot, len);\n                 (e = tab[i]) != null;\n                 i = nextIndex(i, len)) {\n                ThreadLocal<?> k = e.get();\n                if (k == null) {\n                    e.value = null;\n                    tab[i] = null;\n                    size--;\n                } else {\n                    int h = k.threadLocalHashCode & (len - 1);\n                    if (h != i) {\n                        tab[i] = null;\n\n                        // Unlike Knuth 6.4 Algorithm R, we must scan until\n                        // null because multiple entries could have been stale.\n                        while (tab[h] != null)\n                            h = nextIndex(h, len);\n                        tab[h] = e;\n                    }\n                }\n            }\n            return i;\n        }\n\n       \n        private boolean cleanSomeSlots(int i, int n) {\n            boolean removed = false;\n            Entry[] tab = table;\n            int len = tab.length;\n            do {\n                i = nextIndex(i, len);\n                Entry e = tab[i];\n                if (e != null && e.get() == null) {\n                    n = len;\n                    removed = true;\n                    i = expungeStaleEntry(i);\n                }\n            } while ( (n >>>= 1) != 0);\n            return removed;\n        }\n\n\n        private void rehash() {\n            expungeStaleEntries();\n\n            if (size >= threshold - threshold / 4)\n                resize();\n        }\n\n        private void resize() {\n            Entry[] oldTab = table;\n            int oldLen = oldTab.length;\n            int newLen = oldLen * 2;\n            Entry[] newTab = new Entry[newLen];\n            int count = 0;\n\n            for (int j = 0; j < oldLen; ++j) {\n                Entry e = oldTab[j];\n                if (e != null) {\n                    ThreadLocal<?> k = e.get();\n                    if (k == null) {\n                        e.value = null; // Help the GC\n                    } else {\n                        int h = k.threadLocalHashCode & (newLen - 1);\n                        while (newTab[h] != null)\n                            h = nextIndex(h, newLen);\n                        newTab[h] = e;\n                        count++;\n                    }\n                }\n            }\n\n            setThreshold(newLen);\n            size = count;\n            table = newTab;\n        }\n\n        private void expungeStaleEntries() {\n            Entry[] tab = table;\n            int len = tab.length;\n            for (int j = 0; j < len; j++) {\n                Entry e = tab[j];\n                if (e != null && e.get() == null)\n                    expungeStaleEntry(j);\n            }\n        }\n    }\n}\n```\n\n#### ç»“æ„å›¾\n\n![image-20190415225125426](/Users/jingshuo/Library/Application Support/typora-user-images/image-20190415225125426.png)\n\nä»ä¸Šé¢çš„ç»“æ„å›¾ï¼Œæˆ‘ä»¬å·²ç»çª¥è§ThreadLocalçš„æ ¸å¿ƒæœºåˆ¶ï¼š\n\n- æ¯ä¸ªThreadçº¿ç¨‹å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªMapã€‚\n- Mapé‡Œé¢å­˜å‚¨çº¿ç¨‹æœ¬åœ°å¯¹è±¡ï¼ˆkeyï¼‰å’Œçº¿ç¨‹çš„å˜é‡å‰¯æœ¬ï¼ˆvalueï¼‰\n- ä½†æ˜¯ï¼ŒThreadå†…éƒ¨çš„Mapæ˜¯ç”±ThreadLocalç»´æŠ¤çš„ï¼Œç”±ThreadLocalè´Ÿè´£å‘mapè·å–å’Œè®¾ç½®çº¿ç¨‹çš„å˜é‡å€¼ã€‚\n\næ‰€ä»¥å¯¹äºä¸åŒçš„çº¿ç¨‹ï¼Œæ¯æ¬¡è·å–å‰¯æœ¬å€¼æ—¶ï¼Œåˆ«çš„çº¿ç¨‹å¹¶ä¸èƒ½è·å–åˆ°å½“å‰çº¿ç¨‹çš„å‰¯æœ¬å€¼ï¼Œå½¢æˆäº†å‰¯æœ¬çš„éš”ç¦»ï¼Œäº’ä¸å¹²æ‰°ã€‚\n\n- get()æ–¹æ³•ç”¨äºè·å–å½“å‰çº¿ç¨‹çš„å‰¯æœ¬å˜é‡å€¼ã€‚\n- set()æ–¹æ³•ç”¨äºä¿å­˜å½“å‰çº¿ç¨‹çš„å‰¯æœ¬å˜é‡å€¼ã€‚\n- initialValue()ä¸ºå½“å‰çº¿ç¨‹åˆå§‹å‰¯æœ¬å˜é‡å€¼ã€‚\n- remove()æ–¹æ³•ç§»é™¤å½“å‰å‰ç¨‹çš„å‰¯æœ¬å˜é‡å€¼ã€‚"},{"title":"Mybatisçš„if-else","url":"/2019/04/10/Mybatisçš„if-else/","content":"\n## Mybatisçš„if-else\n\n#### mybaits ä¸­æ²¡æœ‰elseè¦ç”¨chose when otherwise ä»£æ›¿\n\nè¡¨ç¤ºæ–¹æ³•ï¼š\n\n```\n<choose>\n    <when test=\"\">\n        //...\n    </when>\n    <otherwise>\n        //...\n    </otherwise>\n</choose>\n```\n\nchooseä¸ºä¸€ä¸ªæ•´ä½“ \nwhenæ˜¯if \notherwiseæ˜¯else\n\nç¤ºä¾‹ï¼š\n\n```\n<select id=\"selectSelective\" resultMap=\"xxx\" parameterType=\"xxx\">\n    select\n    <include refid=\"Base_Column_List\"/>\n    from xxx\n    where del_flag=0\n    <choose>\n        <when test=\"xxx !=null and xxx != ''\">\n            and xxx like concat(concat('%', #{xxx}), '%')\n        </when>\n        <otherwise>\n            and xxx like '**%'\n        </otherwise>\n    </choose>\n</select>\n```\n\n"},{"title":"SpringBootçš„maven-git-commit-id-pluginä½¿ç”¨","url":"/2019/04/09/SpringBootçš„maven-git-commit-id-pluginä½¿ç”¨/","content":"\n## Spring bootçš„maven-git-commit-id-pluginä½¿ç”¨\n\n#### èƒŒæ™¯\n\nåœ¨æ—¥å¸¸å¼€å‘éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œæ‚¨æ˜¯å¦é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼Œå¤šäººåˆä½œæ—¶ï¼Œæµ‹è¯•ç¯å¢ƒä¸çŸ¥é“éƒ¨ç½²çš„å“ªä¸ªåˆ†æ”¯ï¼Œæµ‹è¯•åŒå­¦ä¹Ÿä¸æ¸…æ¥šå¦‚ä½•æbugï¼Ÿçº¿ä¸Šå‡ºç°ç´§æ€¥bugï¼Œä»£ç ä¹Ÿä¸çŸ¥é“åœ¨å“ªä¸ªtagå‡ºçš„é—®é¢˜ï¼Ÿæ˜¯ä¸æ˜¯æˆ‘ä»¬ç´§æ€¥éœ€è¦ä¸€ä¸ªæ¥å£èƒ½å¤Ÿæ¸…æ¥šçš„çŸ¥é“éƒ¨ç½²çš„åˆ†æ”¯æ˜¯å“ªä¸ªåˆ†æ”¯ï¼Œè°éƒ¨ç½²çš„å‘¢ï¼Ÿè¿™ç¯‡æ–‡ç« å°±æ˜¯é€šè¿‡ä¸€ä¸ªé…ç½®  *Maven git commit idæ’ä»¶*å¹¶åˆ›å»ºWebæœåŠ¡ã€‚åœ¨æ­¤ä¹‹åï¼Œç‰ˆæœ¬ä¿¡æ¯ä¼šåœ¨æ¯æ¬¡æ„å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨æ›´æ–°ã€‚\n\n###git commit idæ’ä»¶\n\næ‰€æœ‰å±æ€§çš„è¯¦ç»†ä¿¡æ¯å¯ä»¥åœ¨git commit idæ’ä»¶çš„[GitHub](https://github.com/ktoso/maven-git-commit-id-plugin)å­˜å‚¨åº“ä¸­æ‰¾åˆ°ã€‚\n\n1. æ·»åŠ pomé…ç½®ï¼Œæ’ä»¶éƒ¨åˆ†\n\n```\n<plugin>\n    <groupId>pl.project13.maven</groupId>\n    <artifactId>git-commit-id-plugin</artifactId>\n    <version>2.2.4</version>\n    <executions>\n        <execution>\n            <id>get-the-git-infos</id>\n            <goals>\n                <goal>revision</goal>\n            </goals>\n        </execution>\n    </executions>\n    <configuration>\n        <dotGitDirectory>${project.basedir}/.git</dotGitDirectory>\n        <prefix>git</prefix>\n        <verbose>false</verbose>\n        <generateGitPropertiesFile>true</generateGitPropertiesFile>\n    <generateGitPropertiesFilename>${project.build.outputDirectory}/git.properties</generateGitPropertiesFilename>\n        <format>json</format>\n        <gitDescribe>\n            <skip>false</skip>\n            <always>false</always>\n            <dirty>-dirty</dirty>\n        </gitDescribe>\n    </configuration>\n</plugin>\n```\n\n2. è¿è¡Œmaven build æ„å»ºï¼Œåœ¨targer/classesä¸­ï¼Œgit.properties æ–‡ä»¶ä¸­æ·»åŠ äº†JSONæ ¼å¼çš„ç‰ˆæœ¬ä¿¡æ¯\n\n```\n{\n  \"git.branch\" : \"master\",\n  \"git.build.host\" : \"jingshuodeMacBook-Pro-3.local\",\n  \"git.build.time\" : \"2019-04-07T13:00:13+0800\",\n  \"git.build.user.email\" : \"\",\n  \"git.build.user.name\" : \"\",\n  \"git.build.version\" : \"0.0.1-SNAPSHOT\",\n  \"git.closest.tag.commit.count\" : \"\",\n  \"git.closest.tag.name\" : \"\",\n  \"git.commit.id\" : \"6c6c0fbc1bc18a853d0b9b9361d95e61439f0cac\",\n  \"git.commit.id.abbrev\" : \"6c6c0fb\",\n  \"git.commit.id.describe\" : \"6c6c0fb\",\n  \"git.commit.id.describe-short\" : \"6c6c0fb\",\n  \"git.commit.message.full\" : \"Merge pull request #4 from nebulacollection/develop\\n\\nfeat:æ·»åŠ git commit æ’ä»¶ä»¥åŠæ¥å£ï¼Œä¾¿äºæ‰“åŒ…æ—¶å¯ä»¥ç¡®å®šå½“å‰æ‰“åŒ…ç‰ˆæœ¬\",\n  \"git.commit.message.short\" : \"Merge pull request #4 from nebulacollection/develop\",\n  \"git.commit.time\" : \"2019-03-11T00:26:47+0800\",\n  \"git.commit.user.email\" : \"15763942407@163.com\",\n  \"git.commit.user.name\" : \"ZeyiY\",\n  \"git.dirty\" : \"false\",\n  \"git.remote.origin.url\" : \"https://github.com/nebulacollection/NebulaCollectionApi.git\",\n  \"git.tags\" : \"\"\n}\n```\n\n3. ç‰ˆæœ¬ä¿¡æ¯æ·»åŠ åˆ°RESTful æ¥å£ä¸­\n\næˆ‘ä»¬è¦åšçš„å°±æ˜¯è¯»å–git.properties è¿”å›åˆ°æ¥å£ä¸­\n\n```\n@RestController\npublic class VersionController {\n\n    private static final Logger LOGGER = LoggerFactory.getLogger(VersionController.class);\n\n\n    @RequestMapping(value = \"/version\", method = GET)\n    public String versionInformation() {\n        return readGitProperties();\n    }\n\n    private String readGitProperties() {\n        try {\n            ClassLoader classLoader = getClass().getClassLoader();\n            InputStream inputStream = classLoader.getResourceAsStream(\"git.properties\");\n            return readFromInputStream(inputStream);\n        } catch (IOException e) {\n            LOGGER.error(\"readGitProperties error\", e);\n            return \"Version information could not be retrieved\";\n        }\n    }\n\n    private String readFromInputStream(InputStream inputStream)\n            throws IOException {\n        StringBuilder resultStringBuilder = new StringBuilder();\n        try (BufferedReader br = new BufferedReader(new InputStreamReader(inputStream))) {\n            String line;\n            while ((line = br.readLine()) != null) {\n                resultStringBuilder.append(line).append(\"\\n\");\n            }\n        }\n        return resultStringBuilder.toString();\n    }\n}\n```\n\næ„å»ºè¿è¡Œé¡¹ç›®ï¼Œåœ¨http:localhost:8080/\n\n```\n@RestController\npublic class VersionController {\n\n    private static final Logger LOGGER = LoggerFactory.getLogger(VersionController.class);\n\n\n    @RequestMapping(value = \"/version\", method = GET)\n    public String versionInformation() {\n        return readGitProperties();\n    }\n\n    private String readGitProperties() {\n        try {\n            ClassLoader classLoader = getClass().getClassLoader();\n            InputStream inputStream = classLoader.getResourceAsStream(\"git.properties\");\n            return readFromInputStream(inputStream);\n        } catch (IOException e) {\n            LOGGER.error(\"readGitProperties error\", e);\n            return \"Version information could not be retrieved\";\n        }\n    }\n\n    private String readFromInputStream(InputStream inputStream)\n            throws IOException {\n        StringBuilder resultStringBuilder = new StringBuilder();\n        try (BufferedReader br = new BufferedReader(new InputStreamReader(inputStream))) {\n            String line;\n            while ((line = br.readLine()) != null) {\n                resultStringBuilder.append(line).append(\"\\n\");\n            }\n        }\n        return resultStringBuilder.toString();\n    }\n}\n```\n\næ„å»ºè¿è¡Œé¡¹ç›®ï¼Œåœ¨http:localhost:8080/version å°±å¯ä»¥çœ‹åˆ°æ„å»ºä¿¡æ¯ã€‚\n\n"},{"title":"Javaå…³äºç©ºæŒ‡é’ˆçš„é˜²èŒƒä¸æ€è€ƒ","url":"/2019/04/09/Javaå…³äºç©ºæŒ‡é’ˆçš„é˜²èŒƒä¸æ€è€ƒ/","content":"\n# Javaå…³äºç©ºæŒ‡é’ˆçš„é˜²èŒƒä¸æ€è€ƒ\n\nè½¬è‡ª<https://juejin.im/post/5b9cab616fb9a05d30174491>\n\n### ç©ºæŒ‡é’ˆåˆ†æ\n\nå¯¹äºç©ºæŒ‡é’ˆçš„å‡ºç°ï¼Œå…¶å®ä¸€èˆ¬å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹å‡ ä¸ªåŸå› :\n\n- å¯¹äºæ–¹æ³•å…¥å‚æ²¡æœ‰ä¸¥æ ¼æ ¡éªŒ\n- å¯¹äºæ–¹æ³•è¿”å›å€¼æ²¡æœ‰ä¸¥æ ¼çš„æ ¡éªŒ\n\næœ¬è´¨åŸå› ï¼š\n\nå¯¹äºè°ƒç”¨çš„å…¶ä»–APIæ²¡æœ‰å……åˆ†çš„äº†è§£ï¼Œä½¿ç”¨æ—¶ä¸çŸ¥é“APIæ–¹æ³•çš„å…¥å‚æ˜¯å¦å¯ä»¥æ¥å—nullï¼Œä¸ç¡®å®šæ–¹æ³•çš„è¿”å›å€¼æ˜¯å¦ä¸ºnullã€‚\n\n###ç©ºæŒ‡é’ˆé¿å…æ–¹æ³•\n\nä½¿è°ƒç”¨è€…æ˜ç¡®çŸ¥é“æ–¹æ³•çš„å…¥å‚æ˜¯å¦å¯ä»¥æ¥å—nullï¼Œæ–¹æ³•çš„è¿”å›å€¼æ˜¯å¦å¯ä»¥è¿”å›nullã€‚\n\n##### è¿”å›å€¼ç©ºæŒ‡é’ˆé¿å…\n\n1. ä½¿ç”¨Optional\n\n- Java8å‰ä½¿ç”¨ Google Guavaçš„Optional\n- Java8 å¼•å…¥äº†Optional\n\nOptionalçš„é€‰æ‹©å’Œä½¿ç”¨æ¯”è¾ƒç®€å•ã€‚ä½†æ˜¯Optionalå¹¶ä¸é€‚ç”¨äºæ–¹æ³•å…¥å‚ã€‚\n\n```\n// Java8\npublic static Optional<String> valueOf(Integer number) {\n    if (number == null) {\n        return Optional.empty();\n    }\n    String str = String.valueOf(number);\n    return Optional.of(number);\n}\n```\n\n\n\n2. æ ‡æ³¨æ³¨è§£\n\nä»…ä»…é Optionalæ˜¯ä¸å¤Ÿçš„ã€‚æ–¹æ³•çš„è¿”å›ç±»å‹ä¸æ˜¯Optionalä¸èƒ½è¯´æ˜æ–¹æ³•æ˜¯å¦ä¼šè¿”å›nullï¼Œå› æ­¤éœ€è¦ä¸€ç§æ›´æ˜ç¡®çš„æ–¹å¼ã€‚\n\n##### æ–¹æ³•å…¥å‚æ§åˆ¶å€¼é¿å…\n\n1. æ ‡æ³¨æ³¨è§£\n\n### æ³¨è§£çš„ä½¿ç”¨\n\n1. å¸¸ç”¨çš„æ³¨è§£ï¼š\n\nfindbugs \n\n- edu.umd.cs.findbugs.annotations.NonNull\n- edu.umd.cs.findbugs.annotations.Nullable\n\njsr305 \n\n- javax.annotation.Nonnull\n- javax.annotation.Nullable\n\nspring-core \n\n- org.springframework.lang.NonNull\n- org.springframework.lang.Nullable\n\njavax-validator \n\n- javax.validation.constraints.NotNull\n- javax.validation.constraints.Null\n\nandroid-support \n\n- android.support.annotation.NonNull\n- android.support.annotation.Nullable\n\neclipse-jdt \n\n- org.eclipse.jdt.annotation.NonNull\n- org.eclipse.jdt.annotation.Nullable\n\njetbrains-annotations \n\n- org.jetbrains.annotations.NotNull\n- org.jetbrains.annotations.Nullable\n\nlombok \n\n- lombok.NonNull\n\nrt.jar \n\n- com.sun.istack.internal.NotNull\n- com.sun.istack.internal.Nullable\n\n2. é€‰æ‹©å› ç´ \n\næ³¨è§£å®Œå¤‡æ€§ \n\n- å¿…é¡»åŒæ—¶æ”¯æŒnullæ³¨è§£ä¸énullæ³¨è§£ï¼Œå¦‚æœåªæ”¯æŒå…¶ä¸­ä¸€ä¸ªé‚£ä¹ˆä½¿ç”¨åœºæ™¯å°†ä¼šå—åˆ°å¾ˆå¤§é™åˆ¶\n\nideä»£ç æ£€æŸ¥ \n\n- åœ¨ideä¸­è¿è¡Œçš„æ—¶å€™å¦‚æœèƒ½å¤Ÿå¯¹æ ‡æ³¨énullçš„å‚æ•°å’Œè¿”å›å€¼è¿›è¡Œæ ¡éªŒï¼Œé‚£ä¹ˆä¹ˆå°†åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šé¿å…ç©ºæŒ‡é’ˆ\n\n- æ ¡éªŒé€»è¾‘å¤§è‡´å¦‚ä¸‹:\n\n  ```\n  public static void display(@Nonnull String str) {\n      if (str == null) {\n          throw new IllegalArgumentException();\n      }\n      // do something\n  }\n  å¤åˆ¶ä»£ç \n  ```\n\nideæ³¨è§£ç”Ÿæˆ \n\n- ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ˜¯å¦å¯ä»¥ç›´æ¥ç»§æ‰¿æ ‡æ³¨åœ¨æ–¹æ³•å‚æ•°å’Œè¿”å›ç±»å‹ä¸Šçš„æ³¨è§£ï¼Œè¿™ä¸ªç‰¹æ€§æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºåœ¨å¤§å‹è½¯ä»¶ç³»ç»Ÿçš„ä¸­éƒ½æ˜¯é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œå±‚ä¸å±‚ä¹‹é—´è¿›è¡Œè°ƒç”¨éƒ½æ˜¯é€šè¿‡æ¥å£ï¼Œå› æ­¤ä¸æ”¯æŒè¿™ä¸ªç‰¹æ€§å°†ä¼šå¯¼è‡´å¼€å‘äººå‘˜æ‰‹åŠ¨åœ¨å­ç±»æ–¹æ³•å…¥å‚å’Œè¿”å›ç±»å‹ä¸Šæ ‡æ³¨æ³¨è§£ï¼Œè¿™æ— ç–‘ä¼šå¤§å¤§å¢åŠ å·¥ä½œé‡ã€‚\n\nideæ™ºèƒ½æç¤º \n\n- ä¼šå¯¹æ½œåœ¨äº§ç”Ÿç©ºæŒ‡é’ˆçš„å˜é‡è¿›è¡Œé«˜äº®æ˜¾ç¤º\n\nfindbugsæ”¯æŒ \n\n- ä¸€èˆ¬çš„å…¬å¸éƒ½ä¼šè¦æ±‚å¼€å‘äººå‘˜åœ¨ideä¸Šå®‰è£…findbugsï¼Œç”¨ä»¥æ‰«æä»£ç åˆ†ææ½œåœ¨çš„bug\n\nsonaræ”¯æŒ \n\n- å¤§å‹å…¬å¸éƒ½ä¼šå¯¹ä»£ç è¿›è¡Œé™æ€åˆ†æï¼Œä¸€èˆ¬ä½¿ç”¨SonarCubeï¼ŒSonarCubeå¯ä»¥ç»§æ‰¿fingbugså’Œpmdçš„æ ¡éªŒè§„åˆ™ï¼Œå› æ­¤æ”¯æŒfingdbugså¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¯´æ˜ä¹Ÿæ”¯æŒSonar\n\n3. å„ç±»æ³¨è§£æ”¯æŒæƒ…å†µ\n\n| æ³¨è§£æ”¯æŒåº“            | ç©ºæ³¨è§£   | éç©ºæ³¨è§£  | findbugsæ”¯æŒ | sonaræ”¯æŒ | ideè¿è¡Œæ—¶æ£€æŸ¥ | ideæ™ºèƒ½æç¤º | ideä»£ç ç”Ÿæˆ |\n| --------------------- | -------- | --------- | ------------ | --------- | ------------- | ----------- | ----------- |\n| findbugs              | @NonNull | @Nullable | æ”¯æŒ         | æ”¯æŒ      | æ”¯æŒ          | æ”¯æŒ        | æ”¯æŒ        |\n| jsr305                | @Nonnull | @Nullable | æ”¯æŒ         | æ”¯æŒ      | æ”¯æŒ          | æ”¯æŒ        | æ”¯æŒ        |\n| spring-core           | @NonNull | @Nullable | ä¸æ”¯æŒ       | ä¸æ”¯æŒ    | ä¸æ”¯æŒ        | æ”¯æŒ        | ä¸æ”¯æŒ      |\n| javax-validator       | @NotNull | @Null     | ä¸æ”¯æŒ       | ä¸æ”¯æŒ    | ä¸æ”¯æŒ        | ä¸æ”¯æŒ      | æ”¯æŒ        |\n| android-support       | @NonNull | @Nullable | ä¸æ”¯æŒ       | ä¸æ”¯æŒ    | æ”¯æŒ          | æ”¯æŒ        | æ”¯æŒ        |\n| eclipse-jdt           | @NonNull | @Nullable | ä¸æ”¯æŒ       | ä¸æ”¯æŒ    | ä¸æ”¯æŒ        | æ”¯æŒ        | æ”¯æŒ        |\n| jetbrains-annotations | @NotNull | @Nullable | ä¸æ”¯æŒ       | ä¸æ”¯æŒ    | æ”¯æŒ          | æ”¯æŒ        | æ”¯æŒ        |\n| lombok                | @NonNull | ä¸æ”¯æŒ    | ä¸æ”¯æŒ       | ä¸æ”¯æŒ    | ä¸æ”¯æŒ        | ä¸æ”¯æŒ      | ä¸æ”¯æŒ      |\n| rt.jar                | @NotNull | @Nullable | ä¸æ”¯æŒ       | ä¸æ”¯æŒ    | ä¸æ”¯æŒ        | ä¸æ”¯æŒ      | ä¸æ”¯æŒ      |\n\n######æ³¨æ„\n\næµ‹è¯•ä½¿ç”¨çš„ideæ˜¯Ideaï¼ŒEclipseå­˜åœ¨ä¸€å®šçš„å·®å¼‚\n\nrt.jar @NotNull @Nullableå±äºsunçš„å†…éƒ¨åŒ…ï¼Œä¸è¦ä½¿ç”¨ï¼Œå¦‚æœæœ‰ä»£ç æ£€æŸ¥åˆ™ä¸ä¼šè¢«å…è®¸é€šè¿‡\n\neclipse-jdtå’Œjetbrains-annotationså’Œå¯¹åº”çš„ideç»‘å®šæ¯”è¾ƒç´§å¯†ä¸è¦è½»æ˜“ä½¿ç”¨\n\njavax-validatorå’Œlombokä¸»è¦æ˜¯è¿è¡Œæ—¶çš„å‚æ•°æ£€æŸ¥\n\nfingbugsåŸç”Ÿçš„æ³¨è§£å·²ç»ä¸å†æ¨èï¼Œæ¨èä½¿ç”¨jsr305çš„æ³¨è§£\n\n#####ç»“è®º\n\nä½¿ç”¨jsr305çš„æ³¨è§£\n\nåŸºæœ¬ç±»å‹çš„å…¥å‚å’Œè¿”å›å€¼æ˜¯ä¸éœ€è¦æ ‡æ³¨@Nonnullå’Œ@Nullableæ³¨è§£çš„ï¼›\n\nprivateæ–¹æ³•ï¼Œpackageæ–¹æ³•ï¼Œprotectedæ–¹æ³•ä¹Ÿæ˜¯ä¸éœ€è¦æ ‡æ³¨çš„ï¼›\n\npublicæ–¹æ³•ä¸Šçš„éåŸºæœ¬ç±»å‹å‚æ•°å’Œè¿”å›å€¼éœ€è¦æ ‡æ³¨ã€‚\n\n### ç¤ºä¾‹\n\n* mavenä¾èµ–\n\n```\n<dependency>\n    <groupId>com.google.code.findbugs</groupId>\n    <artifactId>jsr305</artifactId>\n    <version>3.0.2</version>\n</dependency>\n```\n\n* ä½¿ç”¨ç¤ºä¾‹\n\n```\n// éç©ºæ³¨è§£\n@Nonnull\npublic Integer add(@Nonnull Integer number1, @Nonnull Integer number2) {\n    Assert.notNull(number1, \"number1 must not be null\");\n    Assert.notNull(number2, \"number2 must not be null\");\n    return numnber1 + number2;\n}\n\n// ç©ºæ³¨è§£\npublic static boolean isBlank(@Nullable String str) {\n    return str == null || str.trim().length() == 0;\n}\n\n// Optional\n@Nonnull\npublic static Optional<Integer> parseInte(@Nullable String str) {\n    if (str == null) {\n        return Optional.empty();\n    }\n    return Optional.of(Integer.parseInt(str));\n}\n```\n\n* Idea jsr305æ³¨è§£é…ç½®\n\n![Idea jsr305æ³¨è§£é…ç½®](https://user-gold-cdn.xitu.io/2018/9/15/165dbfd6bbbade6c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)"},{"title":"Mysqlçš„æ—¶é—´æ¯”è¾ƒå’ŒDATE_FORMATè¸©çš„å‘","url":"/2019/04/03/Mysqlçš„æ—¶é—´æ¯”è¾ƒå’ŒDATE-FORMATè¸©çš„å‘/","content":"\n### è¸©å‘èƒŒæ™¯ï¼š\n\n   åœ¨ä¸€æ¬¡å…ˆæ’å…¥æ•°æ®å†è¿›è¡ŒæŸ¥è¯¢çš„ä¸šåŠ¡é€»è¾‘æ“ä½œè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªå­—æ®µæ•°æ®åº“ç±»å‹æ˜¯datetime,æ’å…¥æ“ä½œæ˜¯åœ¨javaä»£ç ä¸­new Date(),èµ‹å€¼åˆ°è¯¥æ•°æ®åº“å­—æ®µè¿›è¡Œæ’å…¥ï¼Œè€ŒååŒåŒä¸€ä¸ªdateä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œä»£å…¥sqlè¿›è¡ŒæŸ¥è¯¢ï¼Œç¥å¥‡çš„äº‹æƒ…å‡ºç°äº†ï¼Œç«Ÿç„¶æŸ¥ä¸åˆ°åˆšåˆšæ’å…¥çš„æ•°æ®ã€‚\n\n##### åŸå› åˆ†æï¼š\n\nåœ¨è¿›è¡Œæ’å…¥æ“ä½œä¸­ï¼ŒMysqlåšäº†æ ¼å¼formatï¼Œæ¯«ç§’ä¼šè¿›è¡Œå¤„ç†ï¼Œå››èˆäº”å…¥çš„æ–¹å¼å¤„ç†ï¼Œæœ€ç»ˆå­˜å…¥æ•°æ®åº“çš„æ•°æ®æ¯«ç§’ä½å‡æ˜¯é›¶ï¼Œbut åœ¨è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™æ˜¯ä¸è¿›è¡Œformatçš„ï¼Œä¼šå¸¦æœ‰æ¯«ç±³ä½ï¼Œæ‰€ä»¥ç»å¤§å¤šæ•°æƒ…å†µæ˜¯æŸ¥ä¸åˆ°çš„ï¼Œé™¤énew Date(),æ°å¥½æ˜¯æ•´ç§’ã€‚\n\n##### è§£å†³æ–¹æ¡ˆï¼š\n\nå¯¹æŸ¥è¯¢çš„dateè¿›è¡Œdate_formatã€‚dete_format çš„æ ¼å¼åŒ–æ–¹å¼å’Œå…¶ä»–çš„è¿˜æœ‰å·®åˆ«ï¼Œå…·ä½“å¦‚ä¸‹ï¼š\n\n| æ ¼å¼ | æè¿°                                           |\n| ---- | ---------------------------------------------- |\n| %a   | ç¼©å†™æ˜ŸæœŸå                                     |\n| %b   | ç¼©å†™æœˆå                                       |\n| %c   | æœˆï¼Œæ•°å€¼                                       |\n| %D   | å¸¦æœ‰è‹±æ–‡å‰ç¼€çš„æœˆä¸­çš„å¤©                         |\n| %d   | æœˆçš„å¤©ï¼Œæ•°å€¼(00-31)                            |\n| %e   | æœˆçš„å¤©ï¼Œæ•°å€¼(0-31)                             |\n| %f   | å¾®ç§’                                           |\n| %H   | å°æ—¶ (00-23)                                   |\n| %h   | å°æ—¶ (01-12)                                   |\n| %I   | å°æ—¶ (01-12)                                   |\n| %i   | åˆ†é’Ÿï¼Œæ•°å€¼(00-59)                              |\n| %j   | å¹´çš„å¤© (001-366)                               |\n| %k   | å°æ—¶ (0-23)                                    |\n| %l   | å°æ—¶ (1-12)                                    |\n| %M   | æœˆå                                           |\n| %m   | æœˆï¼Œæ•°å€¼(00-12)                                |\n| %p   | AM æˆ– PM                                       |\n| %r   | æ—¶é—´ï¼Œ12-å°æ—¶ï¼ˆhh:mm:ss AM æˆ– PMï¼‰             |\n| %S   | ç§’(00-59)                                      |\n| %s   | ç§’(00-59)                                      |\n| %T   | æ—¶é—´, 24-å°æ—¶ (hh:mm:ss)                       |\n| %U   | å‘¨ (00-53) æ˜ŸæœŸæ—¥æ˜¯ä¸€å‘¨çš„ç¬¬ä¸€å¤©                |\n| %u   | å‘¨ (00-53) æ˜ŸæœŸä¸€æ˜¯ä¸€å‘¨çš„ç¬¬ä¸€å¤©                |\n| %V   | å‘¨ (01-53) æ˜ŸæœŸæ—¥æ˜¯ä¸€å‘¨çš„ç¬¬ä¸€å¤©ï¼Œä¸ %X ä½¿ç”¨    |\n| %v   | å‘¨ (01-53) æ˜ŸæœŸä¸€æ˜¯ä¸€å‘¨çš„ç¬¬ä¸€å¤©ï¼Œä¸ %x ä½¿ç”¨    |\n| %W   | æ˜ŸæœŸå                                         |\n| %w   | å‘¨çš„å¤© ï¼ˆ0=æ˜ŸæœŸæ—¥, 6=æ˜ŸæœŸå…­ï¼‰                  |\n| %X   | å¹´ï¼Œå…¶ä¸­çš„æ˜ŸæœŸæ—¥æ˜¯å‘¨çš„ç¬¬ä¸€å¤©ï¼Œ4 ä½ï¼Œä¸ %V ä½¿ç”¨ |\n| %x   | å¹´ï¼Œå…¶ä¸­çš„æ˜ŸæœŸä¸€æ˜¯å‘¨çš„ç¬¬ä¸€å¤©ï¼Œ4 ä½ï¼Œä¸ %v ä½¿ç”¨ |\n| %Y   | å¹´ï¼Œ4 ä½                                       |\n| %y   | å¹´ï¼Œ2 ä½                                       |\n\nåŠ¡å¿…æ³¨æ„åˆ†é’Ÿæ˜¯%i\n\n##### ç¤ºä¾‹\n\n```\nDATE_FORMAT(NOW(),'%b %d %Y %h:%i %p')\nDATE_FORMAT(NOW(),'%m-%d-%Y')\nDATE_FORMAT(NOW(),'%d %b %y')\nDATE_FORMAT(NOW(),'%d %b %Y %T:%f')\n```\n\nç»“æœ\n\n```\nDec 29 2008 11:45 PM\n12-29-2008\n29 Dec 08\n29 Dec 2008 16:25:46.635\n```\n\n"},{"title":"MySQLè¯­å¥ä¸­INå’ŒEXISTSçš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯","url":"/2019/04/01/MySQLè¯­å¥ä¸­INå’ŒEXISTSçš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯/","content":"## MySQL SQLè¯­å¥ä¸­IN å’Œ EXISTSçš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯\n\nè½¬è½½ï¼šhttps://blog.csdn.net/wqc19920906/article/details/79800374\n\n### IN è¯­å¥ï¼šåªæ‰§è¡Œä¸€æ¬¡\n\nç¡®å®šç»™å®šçš„å€¼æ˜¯å¦ä¸å­æŸ¥è¯¢æˆ–åˆ—è¡¨ä¸­çš„å€¼ç›¸åŒ¹é…ã€‚\n\ninåœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œé¦–å…ˆæŸ¥è¯¢å­æŸ¥è¯¢çš„è¡¨ï¼Œç„¶åå°†å†…è¡¨å’Œå¤–è¡¨åšä¸€ä¸ªç¬›å¡å°”ç§¯ï¼Œç„¶åæŒ‰ç…§æ¡ä»¶è¿›è¡Œç­›é€‰ã€‚æ‰€ä»¥ç›¸å¯¹å†…è¡¨æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œinçš„é€Ÿåº¦è¾ƒå¿«ã€‚\n\n### EXISTSè¯­å¥ï¼šæ‰§è¡Œå¤–è¡¨ç»“æœ.lengthæ¬¡\n\næŒ‡å®šä¸€ä¸ªå­æŸ¥è¯¢ï¼Œæ£€æµ‹è¡Œçš„å­˜åœ¨ã€‚éå†å¾ªç¯å¤–è¡¨ï¼Œç„¶åçœ‹å¤–è¡¨ä¸­çš„è®°å½•æœ‰æ²¡æœ‰å’Œå†…è¡¨çš„æ•°æ®ä¸€æ ·çš„ã€‚åŒ¹é…ä¸Šå°±å°†ç»“æœæ”¾å…¥ç»“æœé›†ä¸­ã€‚\n\nä½¿ç”¨existså…³é”®å­—è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæŸ¥è¯¢çš„ä¸æ˜¯å­æŸ¥è¯¢çš„å†…å®¹ï¼Œè€Œæ˜¯æŸ¥æˆ‘ä»¬çš„ä¸»æŸ¥è¯¢çš„è¡¨ã€‚\n\nç„¶åï¼Œæ ¹æ®è¡¨çš„æ¯ä¸€æ¡è®°å½•ï¼Œæ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼Œä¾æ¬¡å»åˆ¤æ–­whereåé¢çš„æ¡ä»¶æ˜¯å¦æˆç«‹ã€‚\n\nå¦‚æœæˆç«‹åˆ™è¿”å›trueä¸æˆç«‹åˆ™è¿”å›falseã€‚å¦‚æœè¿”å›çš„æ˜¯trueçš„è¯ï¼Œåˆ™è¯¥è¡Œç»“æœä¿ç•™ï¼Œå¦‚æœè¿”å›çš„æ˜¯falseçš„è¯ï¼Œåˆ™åˆ é™¤è¯¥è¡Œï¼Œæœ€åå°†å¾—åˆ°çš„ç»“æœè¿”å›ã€‚\n\n### åŒºåˆ«åŠåº”ç”¨åœºæ™¯\n\nin å’Œ existsçš„åŒºåˆ«: \n\n1. å¦‚æœå­æŸ¥è¯¢å¾—å‡ºçš„ç»“æœé›†è®°å½•è¾ƒå°‘ï¼Œä¸»æŸ¥è¯¢ä¸­çš„è¡¨è¾ƒå¤§ä¸”åˆæœ‰ç´¢å¼•æ—¶åº”è¯¥ç”¨inã€‚\n2.  åä¹‹å¦‚æœå¤–å±‚çš„ä¸»æŸ¥è¯¢è®°å½•è¾ƒå°‘ï¼Œå­æŸ¥è¯¢ä¸­çš„è¡¨å¤§ï¼Œåˆæœ‰ç´¢å¼•æ—¶ä½¿ç”¨existsã€‚\n3. å…¶å®æˆ‘ä»¬åŒºåˆ†inå’Œexistsä¸»è¦æ˜¯é€ æˆäº†é©±åŠ¨é¡ºåºçš„æ”¹å˜(è¿™æ˜¯æ€§èƒ½å˜åŒ–çš„å…³é”®)ï¼Œå¦‚æœæ˜¯existsï¼Œé‚£ä¹ˆä»¥å¤–å±‚è¡¨ä¸ºé©±åŠ¨è¡¨ï¼Œå…ˆè¢«è®¿é—®ï¼Œå¦‚æœæ˜¯INï¼Œé‚£ä¹ˆå…ˆæ‰§è¡Œå­æŸ¥è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä»¥é©±åŠ¨è¡¨çš„å¿«é€Ÿè¿”å›ä¸ºç›®æ ‡ï¼Œé‚£ä¹ˆå°±ä¼šè€ƒè™‘åˆ°ç´¢å¼•åŠç»“æœé›†çš„å…³ç³»äº† ã€‚\n4. INæ—¶ä¸å¯¹NULLè¿›è¡Œå¤„ç†ã€‚\n5. in æ˜¯æŠŠå¤–è¡¨å’Œå†…è¡¨ä½œhash è¿æ¥ï¼Œè€Œexistsæ˜¯å¯¹å¤–è¡¨ä½œloopå¾ªç¯ï¼Œæ¯æ¬¡loopå¾ªç¯å†å¯¹å†…è¡¨è¿›è¡ŒæŸ¥è¯¢ã€‚\n6. ä¸€ç›´ä»¥æ¥è®¤ä¸ºexistsæ¯”inæ•ˆç‡é«˜çš„è¯´æ³•æ˜¯ä¸å‡†ç¡®çš„ã€‚\n\n### not in å’Œnot exists\n\nâ€‹    å¦‚æœæŸ¥è¯¢è¯­å¥ä½¿ç”¨äº†not in é‚£ä¹ˆå†…å¤–è¡¨éƒ½è¿›è¡Œå…¨è¡¨æ‰«æï¼Œæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼›è€Œnot extsts çš„å­æŸ¥è¯¢ä¾ç„¶èƒ½ç”¨åˆ°è¡¨ä¸Šçš„ç´¢å¼•ã€‚æ‰€ä»¥æ— è®ºé‚£ä¸ªè¡¨å¤§ï¼Œç”¨not existséƒ½æ¯”not inè¦å¿«ã€‚\n\n### åœºæ™¯ç¤ºä¾‹\n\n1. IN æŸ¥è¯¢ç¤ºä¾‹\n\n```\nselect * from A\nwhere id in(select id from B)\n```\n\næŸ¥è¯¢è¿‡ç¨‹ç±»ä¼¼äºä»¥ä¸‹è¿‡ç¨‹\n\n```\nList resultSet=[];\nArray A=(select * from A);\nArray B=(select id from B);\n\nfor(int i=0;i<A.length;i++) {\nÂ Â  for(int j=0;j<B.length;j++) {\nÂ Â Â Â Â  if(A[i].id==B[j].id) {\nÂ Â Â Â Â Â Â Â  resultSet.add(A[i]);\nÂ Â Â Â Â Â  Â  break;\nÂ Â Â Â Â  }\nÂ Â  }\n}\nreturn resultSet;\n```\n\n2. exists æŸ¥è¯¢ç¤ºä¾‹\n\n```\nselect a.* from A a \nwhere exists(select 1 from B b where a.id=b.id)\n```\n\næŸ¥è¯¢è¿‡ç¨‹ç±»ä¼¼äºä»¥ä¸‹è¿‡ç¨‹\n\n```\nList resultSet=[];\nArray A=(select * from A)\n\nfor(int i=0;i<A.length;i++) {\nÂ Â  if(exists(A[i].id) {Â Â Â Â //æ‰§è¡Œselect 1 from B b where b.id=a.idæ˜¯å¦æœ‰è®°å½•è¿”å›\nÂ Â Â Â Â Â  resultSet.add(A[i]);\nÂ Â  }\n}\nreturn resultSet;\n```\n\n3. exists åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨ NULL ä»ç„¶è¿”å›ç»“æœé›†\n\nselect * from TableIn where exists(select null)\nç­‰åŒäºï¼š select * from TableIn\n\n4. \n\n```\nusersè¡¨æœ‰1000æ¡è®°å½•ï¼Œidè‡ªå¢ï¼Œidéƒ½å¤§äº0\n\nselect * from users where exists (select * from users limit 0); --è¾“å‡º1000æ¡è®°å½•\n\nselect * from users where exists (select * from users where id < 0);Â --è¾“å‡º0æ¡è®°å½•\n```\n\nexistsæŸ¥è¯¢çš„æœ¬è´¨ï¼Œåªè¦ç¢°åˆ°æœ‰è®°å½•ï¼Œåˆ™è¿”å›trueï¼›æ‰€ä»¥limitæ ¹æœ¬å°±ä¸ä¼šå»ç®¡ï¼Œæˆ–è€…è¯´æ‰§è¡Œä¸åˆ°ã€‚\n\n5. existsä¸å¯ä»¥å®Œå…¨ä»£æ›¿in\n\n```\n--æ²¡æœ‰å…³è”å­—æ®µçš„æƒ…å†µï¼šæšä¸¾å¸¸é‡\nselect * from areas where id in (4, 5, 6);\n\n--æ²¡æœ‰å…³è”å­—æ®µçš„æƒ…å†µï¼šè¿™æ ·existså¯¹å­æŸ¥è¯¢ï¼Œè¦ä¹ˆå…¨trueï¼Œè¦ä¹ˆå…¨false\nselect * from areas where id in (select city_id from deals where deals.name = 'xxx');Â \n```\n\n6. exists ä¼˜åŒ–\n\nåœ¨è®¸å¤šåŸºäºåŸºç¡€è¡¨çš„æŸ¥è¯¢ä¸­ï¼Œä¸ºäº†æ»¡è¶³ä¸€ä¸ªæ¡ä»¶ï¼Œå¾€å¾€éœ€è¦å¯¹å¦ä¸€ä¸ªè¡¨è¿›è¡Œè”æ¥ã€‚ \nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨exists(æˆ–not exists)é€šå¸¸å°†æé«˜æŸ¥è¯¢çš„æ•ˆç‡ã€‚\n\n```\nï¼ˆä½æ•ˆï¼‰Â \nselect ... from table1 t1 where t1.id > 10 and pno in (select no from table2 where name like 'www%');Â \nï¼ˆé«˜æ•ˆï¼‰Â \nselect ... from table1 t1 where t1.id > 10 and exists (select 1 from table2 t2 where t1.pno = t2.no and name like 'www%');Â \n```\n\n7. ç”¨not existsæ›¿ä»£not in\n\nåœ¨å­æŸ¥è¯¢ä¸­ï¼Œnot inå­å¥å°†æ‰§è¡Œä¸€ä¸ªå†…éƒ¨çš„æ’åºå’Œåˆå¹¶ã€‚ \næ— è®ºåœ¨å“ªç§æƒ…å†µä¸‹ï¼Œnot inéƒ½æ˜¯æœ€ä½æ•ˆçš„ (å› ä¸ºå®ƒå¯¹å­æŸ¥è¯¢ä¸­çš„è¡¨æ‰§è¡Œäº†ä¸€ä¸ªå…¨è¡¨éå†)ã€‚ \nä¸ºäº†é¿å…ä½¿ç”¨not inï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¹å†™æˆå¤–è¿æ¥(Outer Joins)æˆ–not existsã€‚ \n\n8. ç”¨existsæ›¿æ¢distinct\n\nå½“æäº¤ä¸€ä¸ªåŒ…å«ä¸€å¯¹å¤šè¡¨ä¿¡æ¯çš„æŸ¥è¯¢æ—¶,é¿å…åœ¨selectå­å¥ä¸­ä½¿ç”¨distinct. ä¸€èˆ¬å¯ä»¥è€ƒè™‘ç”¨existsæ›¿æ¢ \n\nexistsä½¿æŸ¥è¯¢æ›´ä¸ºè¿…é€Ÿ,å› ä¸ºRDBMSæ ¸å¿ƒæ¨¡å—å°†åœ¨å­æŸ¥è¯¢çš„æ¡ä»¶ä¸€æ—¦æ»¡è¶³å,ç«‹åˆ»è¿”å›ç»“æœ.\n\n```\nï¼ˆä½æ•ˆï¼‰Â \nselect distinct d.dept_no, d.dept_name from t_dept d, t_emp e where d.dept_no = e.dept_no;Â \nï¼ˆé«˜æ•ˆï¼‰Â \nselect d.dept_no, d.dept_name from t_dept d where exists (select 1 from t_emp where d.dept_no = e.dept_no);Â \n```\n\n9. ç”¨è¡¨è¿æ¥æ›¿æ¢exists\n\n```\nï¼ˆä½æ•ˆï¼‰Â \nselect ename from emp e where exists (select 1 from dept where dept_no = e.dept_no and dept_cat = 'W');Â \nSELECT ENAMEÂ \nï¼ˆé«˜æ•ˆï¼‰Â \nselect ename from dept d, emp e where e.dept_no = d.dept_no and dept_cat = 'W'; \n```\n\n"},{"title":"echoipæ­¥éª¤","url":"/2019/03/18/Contos ç¯å¢ƒ Dockerå®‰è£…echoipæ­¥éª¤/","content":"\n## Contos ç¯å¢ƒ Dockerå®‰è£… **echoip**æ­¥éª¤\n\nèƒŒæ™¯ï¼šå› ä¸ºæœ€è¿‘çš„ä¸€äº›ä¸ªäººçš„æƒ³æ³•ï¼Œæ°å¥½éœ€è¦ä½¿ç”¨æ ¹æ®Ipè·å–åœ°ç†ä½ç½®ï¼Œåœ¨ç™¾åº¦å’ŒGoogleä¸­æŸ¥è¯¢äº†å¾ˆå¤šç§æ¥å£ï¼Œè¦ä¹ˆæ”¶è´¹ï¼Œè¦ä¹ˆæœ‰æ¬¡æ•°é™åˆ¶ï¼ŒèŒæ–°å›Šä¸­ç¾æ¶©ï¼Œæ•…è€Œä½¿ç”¨https://github.com/mpolden/echoip è¿™ä¸ªæœåŠ¡äº†ï¼Œå¹¶ä¸”ä½¿ç”¨äº†Docker éƒ¨ç½²çš„æ–¹å¼è¿›è¡Œä½¿ç”¨ã€‚åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­è¸©äº†å¾ˆå¤šå‘ï¼Œæ•…è¿›è€Œè®°å½•ï¼Œä»¥é˜²ä»¥åä½¿ç”¨ã€‚\n\n### ç¯å¢ƒå‡†å¤‡\n\n#### é¦–å…ˆè¦å®‰è£…dockerç¯å¢ƒï¼Œå¹¶è¿è¡Œèµ·æ¥ã€‚\n\n```\nuname -r\n```\n\nDocker è¦æ±‚ CentOS ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬é«˜äº 3.10 ï¼ŒæŸ¥çœ‹æœ¬é¡µé¢çš„å‰ææ¡ä»¶æ¥éªŒè¯ä½ çš„CentOS ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ Docker ã€‚\n\nå®‰è£…ä¸€äº›å¿…è¦çš„ç³»ç»Ÿå·¥å…·\n\n```\nsudo yum install -y yum-utils device-mapper-persistent-data lvm2\n```\n\næ·»åŠ è½¯ä»¶æºä¿¡æ¯ï¼š\n\n```\nsudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n```\n\næ›´æ–° yum ç¼“å­˜ï¼š\n\n```\nsudo yum makecache fast\n```\n\nå®‰è£… Docker-ceï¼š\n\n```\nsudo yum -y install docker-ce\n```\n\nå¯åŠ¨ Docker åå°æœåŠ¡\n\n```\nsudo systemctl start docker\n```\n\næµ‹è¯•è¿è¡Œ hello-world\n\n```\ndocker run hello-world\n```\n\n#### å®‰è£…git\n\n```\nsudo yum install git\n```\n\nå®‰è£…Vim\n\n```\nsudo yum install vim\n```\n\n\n\n### Install docker-ce\n\nClone the project\n\n```\ngit clone https://github.com/alaluces/Docker-EchoIP.git echoip\ncd echoip\n```\n\nDownload the geoip db and extract to geoip folder\n\n```\ncd geoip\nwget https://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz\nwget https://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz\ntar xvf GeoLite2-City.tar.gz\ntar xvf GeoLite2-Country.tar.gz\nmv GeoLite2-City_20190318/GeoLite2-City.mmdb ..\nmv GeoLite2-Country_20190318/GeoLite2-Country.mmdb ..\n\n```\n\nEdit the startup script to modify your preferences\n\n```\nvim start.sh\n\nApplication Options:\n  -f, --country-db=FILE        Path to GeoIP country database\n  -c, --city-db=FILE           Path to GeoIP city database\n  -l, --listen=ADDR            Listening address (default: :8080)\n  -r, --reverse-lookup         Perform reverse hostname lookups\n  -p, --port-lookup            Enable port lookup\n  -t, --template=FILE          Path to template (default: index.html)\n  -H, --trusted-header=NAME    Header to trust for remote IP, if present (e.g. X-Real-IP)\n\nHelp Options:\n  -h, --help                   Show this help message\n```\n\nBuild the container\n\n```\ndocker build -t echoip .\n```\n\nRun the image you built\n\n```\ndocker run -d --rm --name echoip -p8080:8080 echoip\n```\n\nIf built successfully, it can be viewed on:\n\n```\nhttp://ip:8080/json\n```\n\n![gratisography-ski-lift-summer.jpg](https://i.loli.net/2019/03/18/5c8fb80fb113e.jpg)"},{"title":"2019ï¼Œé‡æ–°å¼€å§‹","url":"/2019/03/14/2019ï¼Œé‡æ–°å¼€å§‹/","content":"\n##                                 2019ï¼Œé‡æ–°å¼€å§‹\n\nâ€‹    2019ï¼ŒåŒ—æ¼‚ç¬¬å››å¹´ï¼Œé‡æ–°é€‰æ‹©ï¼Œé‡æ–°å¼€å§‹ã€‚è¦åšçš„äº‹æƒ…å¾ˆå¤šï¼Œä¹‹å‰çš„æƒ³æ³•è¦åœ¨è¿™ä¸€å¹´ä¸­ä¸€ä»¶ä¸€ä»¶çš„å®ç°ï¼Œé¦–å…ˆå°±æ˜¯åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„åšå®¢ï¼Œè™½ç„¶ï¼Œæœ‰è¿™ä¸ªæƒ³æ³•æœ‰å¥½é•¿æ—¶é—´ï¼Œä¸€ç›´æ²¡æœ‰è½åœ°ï¼Œç»ˆäºåœ¨æ˜¨å¤©æŠŠåšå®¢æ­å»ºèµ·æ¥äº†ï¼Œç®—ä¸€ä¸ªå¼€å§‹ã€‚"}]